
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>IsleofWatch</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { margin:0; font-family: Arial, sans-serif; background:#111; color:#fff; }
  header { padding:20px; text-align:center; background:#222; }
  input#search { width:60%; padding:10px; font-size:16px; border-radius:4px; border:none; }
  section { padding:20px; }
  h2 { margin:10px 0; }
  .grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:15px; }
  .card { background:#222; padding:10px; border-radius:6px; cursor:pointer; transition: transform .2s; text-align:center; }
  .card:hover { transform: scale(1.05); }
  .card img { width:100%; border-radius:4px; }
  .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); justify-content:center; align-items:center; z-index:1000; }
  .modal iframe { width:80%; height:80%; border:none; }
  .modal .close { position:absolute; top:20px; right:30px; font-size:30px; cursor:pointer; color:#fff; }
</style>
</head>
<body>
<header>
  <h1>IsleofWatch</h1>
  <input type="text" id="search" placeholder="Search for movies, anime or TV series...">
</header>
<div id="content"></div>

<div class="modal" id="modal">
  <span class="close" id="closeBtn">&times;</span>
  <iframe id="player" allowfullscreen></iframe>
</div>

<script>
const modal = document.getElementById('modal');
const player = document.getElementById('player');
const closeBtn = document.getElementById('closeBtn');
const searchInput = document.getElementById('search');
const contentDiv = document.getElementById('content');

async function loadMovies() {
  try {
    const res = await fetch('movies.json');
    const movies = await res.json();

    // Sort by releaseDate descending (latest first)
    movies.sort((a,b) => new Date(b.releaseDate) - new Date(a.releaseDate));

    // Group by category
    const sections = {};
    movies.forEach(m => {
      if (!sections[m.category]) sections[m.category] = [];
      sections[m.category].push(m);
    });

    contentDiv.innerHTML = '';
    for (const category in sections) {
      const sectionEl = document.createElement('section');
      sectionEl.innerHTML = `<h2>${category}</h2>`;
      const grid = document.createElement('div');
      grid.className = 'grid';
      sections[category].forEach(m => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img src="${m.thumbnail}" alt="${m.title}">
          <h3>${m.title}</h3>
        `;
        card.onclick = () => playMovie(m.embed);
        grid.appendChild(card);
      });
      sectionEl.appendChild(grid);
      contentDiv.appendChild(sectionEl);
    }

  } catch (err) {
    contentDiv.innerHTML = '<p style="text-align:center">Error loading content.</p>';
    console.error(err);
  }
}

function playMovie(url) {
  player.src = url;
  modal.style.display = 'flex';
}

closeBtn.onclick = () => {
  player.src = '';
  modal.style.display = 'none';
};

// Search
searchInput.addEventListener('keyup', () => {
  const query = searchInput.value.toLowerCase();
  const cards = document.querySelectorAll('.card');
  cards.forEach(card => {
    const title = card.querySelector('h3').textContent.toLowerCase();
    card.style.display = title.includes(query) ? '' : 'none';
  });
});

// Initial load
loadMovies();
</script>
</body>
</html>
